#!/system/bin/sh
# =======================================================#
# Codename: LKT
# Author: korom42 @ XDA
# Device: Universal
# =======================================================#
# THE BEST BATTERY MOD YOU CAN EVER USE
# JUST FLASH AND FORGET
# =======================================================#
# Script Begins -
# =======================================================#
# Colors
# =======================================================#
BL='\e[01;90m' > /dev/null 2>&1; # Black
R='\e[01;91m' > /dev/null 2>&1; # Red
G='\e[01;92m' > /dev/null 2>&1; # Green
Y='\e[01;93m' > /dev/null 2>&1; # Yellow
B='\e[01;94m' > /dev/null 2>&1; # Blue
P='\e[01;95m' > /dev/null 2>&1; # Purple
C='\e[01;96m' > /dev/null 2>&1; # Cyan
W='\e[01;97m' > /dev/null 2>&1; # White
LG='\e[01;37m' > /dev/null 2>&1; # Light Gray
N='\e[0m' > /dev/null 2>&1; # Null
# =======================================================#

# Divider
# =======================================================#
divider="-------------------------------------------------"

# Check Root
# ----------------------------------------
id="$(id)"; id="${id#*=}"; id="${id%%\(*}"; id="${id%% *}"
if [ "$id" != "0" ] && [ "$id" != "root" ]; then
echo ""
echo -e $R"$divider"$N
echo -e $R'E R R O R'$N
echo -e $R"$divider"$N
sleep 0.5
echo -e $R" YOU NEED ROOT ACCESS TO RUN LKT COMMANDS"$N
echo -e $R" PLEASE TYPE" $G"su" $R"BEFORE RUNNING " $G"lkt" $R"command"$N
echo -e $R" THEN TRY AGAIN."$N
echo -e $R"$divider"$N
sleep 5
clear 
echo -e $W'[+] Aborting...'$N
sleep 1
clear
exit 0
fi

# Mount Magisk
# =======================================================#
if [ ! -d /sbin/.core/mirror/bin ]; then
    mkdir -p /sbin/.core/mirror/bin
    mount -o bind /data/adb/magisk /sbin/.core/mirror/bin
fi

# Versioning & Date
# =======================================================#
version=$Y'1.3.9'$N > /dev/null 2>&1
released=$G'Dec 29, 2018'$N > /dev/null 2>&1
saythanks='https://saythanks.io/to/korom42' > /dev/null 2>&1
date=$(date "+%d.%m.%Y %H:%M:%S")

# Start Echos
# =======================================================#
clear
echo ''
echo -e $Y"        __   __ ________ "$N; sleep 0.1;
echo -e $Y"       / /  / //_/_  __/ "$N; sleep 0.1;
echo -e $Y"      / /__/ ,<   / /    "$N; sleep 0.1;
echo -e $Y"     /____/_/|_| /_/     "$N; sleep 0.1;
echo ''
echo -e $Y'   legendary.kernel.tweaks'$N 
sleep 0.1
echo "$divider" 
echo "      Version: $version | Updated: $released"
sleep 0.1
echo "$divider"
sleep 0.1
echo ""
sleep 0.1
echo "      GNU General Public License v3"
echo ''
sleep 0.5
echo -n -e $Y'                        •'$N; sleep 0.2; 
echo -n -e $Y'•'$N; sleep 0.3;
echo -n -e $Y'•'$N; sleep 0.2;
sleep 2
clear


# Disclaimer
# =======================================================#
echo -e $R"$divider"$N
echo -e $R'D I S C L A I M E R'$N
echo -e $R"$divider"$N
sleep 0.1
echo -e $R" LKT IS AN ADVANCED KERNEL TWEAKS COLLECTION."$N
echo -e $R" IF YOU DON'T KNOW HOW IT WORKS THEN"$N
echo -e $R" I WON'T BE RESPONSIBLE FOR ANY DAMAGE."$N
echo -e $R" USE IT AT YOUR OWN RISK."$N
echo -e $R" ALWAYS HAVE BACKUPS."$N
echo ''
sleep 1
echo -e $Y"$divider"$N
echo -e $Y'W A R N I N G'$N
echo -e $Y"$divider"$N
sleep 0.1
echo -e $Y"IF YOU ARE NEW TO THIS MODULE."$N
echo -e $Y"THEN PLEASE EDUCATE YOURSLEF ABOUT IT."$N
echo -e $Y"READ FAQ BEFORE ASKING ANYTHING."$N
echo ''
sleep 1
echo -e $P"$divider"$N
echo -e $P'S U P P O R T  D E V E L O P M E N T'$N
echo -e $P"$divider"$N
sleep 0.1
echo -e $P"IF YOU LOVED OUR WORK, CONSIDER DONATING; TO"$N
echo -e $P"KEEP THE PROJECT ALIVE AND RUNNING."$N
echo -e $P"$divider"$N
echo ''
sleep 2

# Check Magisk Version
# =======================================================#
clear
echo "[+] Checking Magisk Support"; sleep "0.1"; clear
echo "[+] Checking Magisk Support."; sleep "0.1"; clear
echo "[+] Checking Magisk Support.."; sleep "0.1"; clear
echo "[+] Checking Magisk Support..."; sleep "0.1"; clear
echo "[+] Checking Magisk Support.."; sleep "0.01"; clear
echo "[+] Checking Magisk Support."; sleep "0.01"; clear
echo "[+] Checking Magisk Support"; sleep "0.01"; clear

# =======================================================#
MAGISK_VERSION="$(/sbin/magisk -c | /sbin/.core/busybox/grep -Eo '[1-9]{2}\.[0-9]+')"
case "$MAGISK_VERSION" in
'15.'[1-9]*) # Version 15.1 - 15.9
echo -e $Y'W A R N I N G'$N
sleep "0.01"
echo -e $Y"You are using an outdated Magisk version ($1)"$N
sleep "0.01"
echo -e $Y"To avoid issues. Consider updating to latest Magisk release"$N
;;
'16.'[1-9]*) # Version 16.1 - 16.9
echo -e $Y'W A R N I N G'$N
sleep "0.01"
echo -e $Y"You are using an outdated Magisk version ($1)"$N
sleep "0.01"
echo -e $Y"To avoid issues. Consider updating to latest Magisk release"$N
;;
'17.'[1-3]*) # Version 17.1 - 17.3
echo -e $Y'W A R N I N G'$N
sleep "0.01"
echo -e $Y"You are using an outdated Magisk version ($1)"$N
sleep "0.01"
echo -e $Y"To avoid issues. Consider updating to latest Magisk release"$N
;;
'17.'[4-9]*) # Version 17.4 - 17.9
echo -e $Y'W A R N I N G'$N
sleep "0.01"
echo -e $Y"You are using an outdated Magisk version ($1)"$N
sleep "0.01"
echo -e $Y"To avoid issues. Consider updating to latest Magisk release"$N
;;
'18.'[0-9]*) # Version 18.x
echo -e $G'S U C C E S S'$N
sleep "0.01"
echo -e $G"Superbe Dude! You are using the latest Magisk version"$N
;;
*)
echo -e $R'W A R N I N G'$N; sleep "0.01"; clear
echo -e $R"Magisk not found or Unknown version: $1"$N; sleep "0.01"; clear
;;
esac
sleep 2

# Check LKT files
# =======================================================#
clear
echo "[+] Checking LKT files"; sleep "0.1"; clear
echo "[+] Checking LKT files"; sleep "0.1"; clear
echo "[+] Checking LKT files"; sleep "0.1"; clear
echo "[+] Checking LKT files"; sleep "0.1"; clear
echo "[+] Checking LKT files"; sleep "0.1"; clear
echo "[+] Checking LKT files"; sleep "0.1"; clear
echo "[+] Checking LKT files"; sleep "0.1"; clear

# =======================================================#
MODPATH='/sbin/.core/img/legendary_kernel_tweaks' 2>/dev/null
busybox='/sbin/.core/mirror/bin/busybox' 2>/dev/null
bboxname=$C"`busybox | head -1 | cut -f 2 -d ' '`"$N

if [ -e "${MODPATH}/service.sh" ]; then
echo -e $G'S U C C E S S'$N
sleep "0.01"
echo -e $G"Superbe Dude! LKT IS CORRECTLY INSTALLED"$N
sleep 1
else
echo -e $R"$divider"$N
echo -e $R'E R R O R'$N
echo -e $R"$divider"$N
echo -e $R"LKT PROFILES ARE NOT FOUND."$N
echo -e $R"PLEASE RE-INSTALL THE MODULE THEN TRY AGAIN"$N
echo -e $R"IF YOU KEEP GETTING THIS ERROR YOU CAN ALWAYS."$N
echo -e $R"CHANGE LKT PROFILE WHEN FLASHING THEN REBOOT"$N
clear 
sleep "0.01"
echo -e $Y"$divider"$N
sleep "0.01"
echo -e $Y'--------------- T H A N K   Y O U ---------------'$N
sleep "0.01"
echo -e $Y"$divider"$N
echo ''
sleep "0.01"
echo -e $Y'        Omar Koulache - @korom42 - XDA'$N
sleep "0.01"
echo -e $Y'        @yc9559 - Coolapk'$N
sleep "0.01"
echo -e $Y'        @cjybyjk - Coolapk'$N
sleep 2
exit 0
fi

# TIP 1
# =======================================================#
clear
echo -e $G"$divider"$N
echo -e $G"T I P s"$N
echo -e $G"$divider"$N
echo ''
echo -e $W'~ NOT SURE WHAT YOU ARE DOING?\n- PICK BALANCED PROFILE! ;)'$N
sleep 0.1
echo ''
echo -e $W'~ NEED MORE INFO?\n- TYPE T AND JOIN OUR CHAT! B)'$N
sleep 0.1
echo ''
echo -e $W'~ WANT TO GO TO MAGISK DIRECTLY FROM\nTHE SCRIPT? - TYPE MAGISK & HIT ENTER! :D'$N
sleep 2

# Features & Main Parts
# =======================================================#
while true
do
# Aliases & Variables
# =======================================================#
COUNT=1

# Input
# =======================================================#
INPUT=$(eval "echo \$$COUNT")
	if [ ! "$INPUT" ]; then
		if [ "$1" ]; then
			rm -f $TREADME
			exit 0
		fi
# Starts Screen Echos
# =======================================================#
clear
echo ''
echo -e $Y"        __   __ ________ "$N; sleep 0.1;
echo -e $Y"       / /  / //_/_  __/ "$N; sleep 0.1;
echo -e $Y"      / /__/ ,<   / /    "$N; sleep 0.1;
echo -e $Y"     /____/_/|_| /_/     "$N; sleep 0.1;
echo ''
sleep 0.1
echo -e $Y'   legendary.kernel.tweaks'$N 
echo -e $Y"                             v.$version"
sleep 0.1
echo -e $Y"$divider"$N
sleep 0.1
echo -e $Y' B A S I C  I N F O -'$N
sleep 0.1
echo -e $Y"$divider"$N
sleep 0.1
echo -e $Y"             "$N$W"[+] BUSYBOX: $bboxname"$N
sleep 0.1
echo -e $Y"$divider"$N
sleep 0.5
echo -n -e $Y'                        •'$N; sleep 0.2; 
echo -n -e $Y'•'$N; sleep 0.3;
echo -n -e $Y'•'$N; sleep 0.2;
sleep 1
clear

# Profiles
# =======================================================#
echo -e $C"L K T    P R O F I L E S -             "$N
sleep 0.1
echo -e $C"$divider"$N
sleep 0.1
echo -e $W"[1] Battery         [3] Performance"$N
sleep 0.1
echo -e $W"[2] Balanced        [4] Turbo"$N
echo -e $C"$divider"$N
sleep 0.1
echo -e $C'OTHER OPTIONS -'$N
sleep 0.1
echo -e $C"$divider"$N
sleep 0.1
echo -e $W'[?] FAQ (Frequently Asked Questions)'$N
sleep 0.1
echo -e $W'[j] Join Telegram chat'$N
sleep 0.1
echo -e $W'[tk] Say Thanks'$N
sleep 0.1
echo -e $W'[d] Donate to developer'$N
sleep 0.1
echo -e $W'[x] Exit.   '$N
echo -e $C"$divider"$N
sleep 0.1
# Read Input


# Read Input
# =======================================================#
		echo -n $Y"[+] Your Input - "$N
		read -r INPUT

		DIR=""
	fi
	case ${INPUT} in
	    # BATTERY
		1* | batt*) 
		clear
		echo -e $Y"$divider"$N
		sleep "0.01"
		echo $W'[+] Applying Battery Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Battery Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Battery Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Battery Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Battery Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Battery Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Battery Profile'$N; sleep "0.1"; clear
		echo -e $G'[+] Applying Battery ... Please wait'$N
		sleep 0.1
		sh ${MODPATH}/service.sh "0" "0" > /dev/null 2>&1
		;;
		
		# BALANCED
		2* | balan*)
		clear
		echo -e $Y"$divider"$N
		sleep "0.01"
		echo $W'[+] Applying Balanced Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Balanced Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Balanced Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Balanced Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Balanced Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Balanced Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Balanced Profile'$N; sleep "0.1"; clear
		echo -e $G'[+] Applying Balanced Profile ... Please wait'$N
		sh ${MODPATH}/service.sh "1" "0" > /dev/null 2>&1
		sleep 0.1
		;;
		
		# Performance
		3* | perf*)
		clear
		echo -e $Y"$divider"$N
		sleep "0.01"
		echo $W'[+] Applying Performance Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Performance Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Performance Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Performance Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Performance Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Performance Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Performance Profile'$N; sleep "0.1"; clear
		echo -e $G'[+] Applying Performance Profile ... Please wait'$N
		sh ${MODPATH}/service.sh "2" "0" > /dev/null 2>&1
		sleep 0.1
		;;
		
		# Turbo
		4* | turb*)
		clear
		echo -e $Y"$divider"$N
		sleep "0.01"
		echo $W'[+] Applying Turbo Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Turbo Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Turbo Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Turbo Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Turbo Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Turbo Profile'$N; sleep "0.1"; clear
		echo $W'[+] Applying Turbo Profile'$N; sleep "0.1"; clear
		echo -e $G'[+] Applying Turbo Profile ... Please wait'$N
		sh ${MODPATH}/service.sh "3" "0" > /dev/null 2>&1
		sleep 0.1

		;;
		
		# Donate
		# =======================================================#
		d* )
		
		am start -a android.intent.action.VIEW -d "http://bit.ly/2AlA5Mi" > /dev/null 2>&1
		;;
		
		tk* | thank*) am start -a android.intent.action.VIEW -d "$saythanks"
		;;

		# FAQ
		# =======================================================#
		faq* | "?")

		am start -a android.intent.action.VIEW -d "https://telegra.ph/FAQ-12-24-2" > /dev/null 2>&1
		;;
		
		# Telegram
		# =======================================================#
		tg | teleg* | "j" | "join")

		am start -a android.intent.action.VIEW -d "https://t.me/LKT_XDA" > /dev/null 2>&1
		;;
		
		# Exit
		# =======================================================#
		"q" | "x" | "exit") break
		clear
		reset
		;;
		
		*)
		echo -e $R"$divider"$N
			echo -e $R"----------- I N V A L I D  I N P U T ! ----------"$N
			echo -e $R"$divider"$N
			sleep "0.5"
		;;
		esac
		
		COUNT=$((COUNT+1))
		clear
		reset
		
		case ${INPUT} in
		1* | 2* | 3* | 4* | batt* | balan* | perf* | turb*)
		echo -e $G'[+] DONE'$N
		sleep 0.5
		echo -e $W'[+] NO NEED TO REBOOT AFTER APPLYING.'$N
		sleep 2
		echo -e $Y"$divider"$N
		sleep 0.1
		echo -e $Y'[+] If you loved this work, consider donating.'$N
		sleep 0.1
		;;
		esac
		echo -e $W'[+] Returning...'$N
		sleep 0.5
		clear
    done	
		
# Script Ends
# =======================================================#
clear 
sleep "0.01"
echo -e $Y"$divider"$N
sleep "0.01"
echo -e $Y'--------------- T H A N K   Y O U ---------------'$N
sleep "0.01"
echo -e $Y"$divider"$N
echo ''
sleep "0.01"
echo -e $Y'        Omar Koulache - @korom42 - XDA'$N
sleep "0.01"
sleep 1.25
clear 
sleep "0.01"
echo -e $G"$divider"$N
sleep "0.01"
echo -n -e $G"#   "$N; sleep "0.01"; 
echo -n -e $W'E '$N; sleep "0.01"; 
echo -n -e $W'N '$N; sleep "0.01"; 
echo -n -e $W'O '$N; sleep "0.01"; 
echo -n -e $W'J '$N; sleep "0.01"; 
echo -n -e $W' A '$N; sleep "0.01"; 
echo -n -e $W' N '$N; sleep "0.01"; 
echo -n -e $W'E '$N; sleep "0.01"; 
echo -n -e $W'W '$N; sleep "0.01"; 
echo -n -e $W' E '$N; sleep "0.01"; 
echo -n -e $W'X '$N; sleep "0.01"; 
echo -n -e $W'P '$N; sleep "0.01"; 
echo -n -e $W'E '$N; sleep "0.01"; 
echo -n -e $W'R '$N; sleep "0.01"; 
echo -n -e $W'I '$N; sleep "0.01"; 
echo -n -e $W'E '$N; sleep "0.01"; 
echo -n -e $W'N '$N; sleep "0.01"; 
echo -n -e $W'C '$N; sleep "0.01";
echo -n -e $W'E '$N; sleep "0.01"; 
echo -e $G'   #'$N;
sleep "0.01"
echo -e $G"$divider"$N
echo ""
sleep 1
clear 
exit 0
